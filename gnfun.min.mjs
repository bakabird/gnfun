class FreeListIterator{constructor(t){this._list=t,this._next=0}hasNext(){return this._next<this._list.size}peekNext(){return this._list.at(this._next)}getNext(){return this._list.at(this._next++)}moveNext(){++this._next}get nextIndex(){return this._next}get _nextIndex(){return this._next}set _nextIndex(t){this._next=t}}class FreeList{constructor(t){this._ary=t||[],this._it=new FreeListIterator(this),this._tempIts=null,this._poolIts=null}get it(){return this._it._nextIndex=0,this._it}beginVisit(){let t;return this._tempIts||(this._tempIts=[]),(t=this._poolIts&&0<this._poolIts.length?this._poolIts.pop():new FreeListIterator(this))._nextIndex=0,this._tempIts.push(t),t}endVisit(t){var e=this._tempIts.indexOf(t);-1!==e&&(this._tempIts.splice(e,1),this._poolIts||(this._poolIts=[]),this._poolIts.push(t))}get size(){return this._ary.length}get length(){return this._ary.length}at(t){return this._ary[t]}get front(){return this._ary[0]}get back(){return this._ary[this._ary.length-1]}push(t){return this._adjustItByAdd(this._ary.length,1),this._ary.push(t)}pop(){if(0<this._ary.length)return this._adjustItByRemove(this._ary.length-1,1),this._ary.pop()}unshift(t){return this._adjustItByAdd(0,1),this._ary.unshift(t)}shift(){if(0<this._ary.length)return this._adjustItByRemove(0,1),this._ary.shift()}indexOf(t,e){return this._ary.indexOf(t,e)}indexIf(e,s){for(let t=s=s||0;t<this._ary.length;++t)if(e(this._ary[t]))return t;return-1}findFirstIf(e){for(let t=0;t<this._ary.length;++t)if(e(this._ary[t]))return this._ary[t]}remove(t){return this.removeAt(this.indexOf(t))}unsafeReverse(){this._ary.reverse()}removeAt(t){var e;if(0<=t&&t<this._ary.length)return this._adjustItByRemove(t,1),e=this._ary[t],this._ary.splice(t,1),e}splice(t,e){if(0<=t&&t<this._ary.length)return e=Math.min(e,this._ary.length-t),this._adjustItByRemove(t,e),this._ary.splice(t,e)}removeFirstIf(e,s){for(let t=s=s||0;t<this._ary.length;++t)if(e(this._ary[t]))return this.removeAt(t)}removeIf(s){var r=this._ary;if(0!=r.length){let t=0,e=0;for(;t<r.length;t++)s(r[t])||(r[e++]=r[t]);e<t&&(this._adjustItByRemove(e,t-e),r.splice(e,t-e))}}insert(t,e){return e<0||e>=this._ary.length?this.push(t):(this._adjustItByAdd(e,1),this._ary.splice(e,0,t),this._ary.length)}foreach_unsafe(e,s){for(let t=s=s||0;t<this._ary.length;++t)if(!1===e(this._ary[t]))return!1;return!0}foreach(t,e){e=e||0;for(var s=this.it;s.hasNext();)if(s.nextIndex<e)s.moveNext();else if(!1===t(s.getNext()))return!1;return!0}foreach_safe(t,e){let s=!0;e=e||0;for(var r=this.beginVisit();r.hasNext();)if(r.nextIndex<e)r.moveNext();else if(!1===t(r.getNext())){s=!1;break}return this.endVisit(r),s}map(e){let s=[],r=0;return this.foreach_unsafe(t=>(s.push(e(t,r++)),!0)),s}clear(){if(this._it._nextIndex=0,this._ary.length=0,this._tempIts)for(let t=0;t<this._tempIts.length;++t)this._tempIts[t]._nextIndex=0}clone(t,e){return this.copyTo(new FreeList,t,e)}copyTo(e,s,t){s=Math.max(0,s||0),null==t&&(t=this._ary.length);var r=Math.min(s+t,this._ary.length);for(let t=s;t<r;++t)e.push(this._ary[t]);return e}_adjustItByAdd(e,s){if(this._it._nextIndex>e&&(this._it._nextIndex+=s),this._tempIts)for(let t=0;t<this._tempIts.length;++t){var r=this._tempIts[t];r._nextIndex>e&&(r._nextIndex+=s)}}_adjustItByRemove(e,s){if(this._it._nextIndex>e&&(this._it._nextIndex=Math.max(e+s,this._it._nextIndex)-s),this._tempIts)for(let t=0;t<this._tempIts.length;++t){var r=this._tempIts[t];r._nextIndex>e&&(r._nextIndex=Math.max(e+s,r._nextIndex)-s)}}report(){console.log("reprot >"),console.log(this._ary),console.log("reprot <")}}class PoolModule{constructor(t,e){this._ctor=t,this._dtor=e,this._pool=[]}alloc(){return 0<this._pool.length?this._pool.shift():this._ctor()}free(t){var e;null!=(e=this._dtor)&&e.call(this,t),this._pool.push(t)}}class CountdownRunner{get bindedCountdown(){return this.countdown.bind(this)}constructor(t,e){this._countdown=t,this._run=e}countdown(){var t;--this._countdown,this._countdown<=0&&(null!=(t=this._run)&&t.call(this),this._run=void 0)}}class RoundRunner{get over(){return 0==this._steps.length}constructor(){this._steps=new FreeList}append(t){this._steps.push(t)}reverse(){this._steps.unsafeReverse()}runRound(t){let e=0,s;this._steps.foreach_safe(()=>(e++,(s=this._steps.shift())(),e<t))}runAll(){for(;0!=this._steps.length;)this._steps.shift()()}produceExecuteBody(t,e,s){const r=()=>{0<t?this.runRound(t):this.runAll(),this.over?s(this):e(r)};return r}}const easyEncodeDist={a:"l",b:"k",c:"j",d:"i",e:"h",f:"g",g:"f",h:"e",i:"d",j:"c",k:"b",l:"a",m:"t",n:"s",o:"r",p:"q",q:"p",r:"o",s:"n",t:"m",u:"z",v:"y",w:"x",x:"w",y:"v",z:"u",A:"L",B:"K",C:"J",D:"I",E:"H",F:"G",G:"F",H:"E",I:"D",J:"C",K:"B",L:"A",M:"T",N:"S",O:"R",P:"Q",Q:"P",R:"O",S:"N",T:"M",U:"Z",V:"Y",W:"X",X:"W",Y:"V",Z:"U"};function easyEncode(e){let s="";for(let t=0;t<e.length;t++){var r=e[t];s+=easyEncodeDist[r]||r}return s}function className(t){return t.constructor.name}function deepClone(t){if(null==t||t)return t;var e,s,r,n=Object.prototype.toString.call(t);if("[object Array]"===n)for(e=[],s=0,r=t.length;s<r;s++)e.push(deepClone(t[s]));else{if("[object Object]"!==n)return t;for(s in e={},t)e[s]=deepClone(t[s])}return e}function emptyString(t){return!(null!=t&&!t)||""===t}function remap(t,e,s,r,n){return(t-e)/(s-e)*(n-r)+r}function objectValues(e){var t=Object.prototype.toString.call(e);if(null==e)throw new TypeError("Cannot convert undefined or null to object");if(~["[object String]","[object Object]","[object Array]","[object Function]"].indexOf(t)){if(Object.keys)return Object.keys(e).map(function(t){return e[t]});var s,r=[];for(s in e)e.hasOwnProperty(s)&&r.push(e[s]);return r}return[]}function getEnumName(e,s){return Object.keys(e).find(t=>e[t]==s)}function enumValues(t,e){return"string"==e?objectValues(t):objectValues(t).filter(t=>"number"==typeof t)}function enumKeys(e,t){return"string"==t?Object.keys(e):Object.keys(e).filter(t=>"number"==typeof e[t])}function isNull(t){return null==t}function notNull(t){return null!=t}function removeNullKeys(t){var e,s={};for(const r in t)t.hasOwnProperty(r)&&notNull(e=t[r])&&(s[r]=e);return s}export{CountdownRunner,FreeList,PoolModule,RoundRunner,className,deepClone,easyEncode,emptyString,enumKeys,enumValues,getEnumName,isNull,notNull,objectValues,remap,removeNullKeys};